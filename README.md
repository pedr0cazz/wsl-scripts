# WSL Webâ€‘Dev Environment Scripts

Welcome to **wslâ€‘scripts**, a collection of helper scripts designed to streamline your webâ€‘development setup on Windows Subsystem for Linux (WSL). With just a single installer, you can:

- Install essential dev packages (build tools, Nginx, MySQL, Redis, PHP, Node.js, Composer, etc.)
- Configure Zsh with Oh My Zsh, Powerlevel10k theme, and useful plugins
- Generate and manage local SSL certificates for `*.test` domains
- Inject shell helpers for automatic SSL renewal, Composer versioning, and SSH agent startup

---

## Repository Contents

```text
~/.wsl_scripts/
â”œâ”€â”€ wsl-setup.sh       # Main installer and orchestrator
â”œâ”€â”€ ssl-manager.sh     # Generate/manage SSL certs & Nginx vhosts
â””â”€â”€ zshrc-helpers.sh   # Zsh configuration snippets (auto-run SSL manager, composer wrapper, ssh-agent)
```

---

## Prerequisites

- **WSL 2** on Windows 10/11, running an Ubuntu (or Debian) distribution
- **Git** installed within WSL
- Internet connection to fetch packages and clone this repo
- **Nerd Font** installed on your Windows terminal emulator (Powerlevel10k requires a Powerline-patched font). Fonts must be installed in Windows, not inside WSL. Follow your terminalâ€™s font settings to select the Nerd Font.

---

## Installing a Nerd Font

Powerlevel10k requires the **MesloLGS Nerd Font** patched with Powerline icons. Download and install these four font files in Windows:

1. [MesloLGS NF Regular.ttf](https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf)
2. [MesloLGS NF Bold.ttf](https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf)
3. [MesloLGS NF Italic.ttf](https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf)
4. [MesloLGS NF Bold Italic.ttf](https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf)

Steps to install:

1. **Download** the four `.ttf` files from the URLs above.
2. **Install** each by rightâ€‘clicking and choosing **Install for all users** (or **Install**).
3. **Configure your terminal**:
   - **Windows Terminal** â†’ Settings â†’ Profiles â†’ your WSL distro â†’ Appearance â†’ set **Font face** to `MesloLGS NF`.
   - **Legacy Console** â†’ rightâ€‘click title bar â†’ Properties â†’ Font â†’ select one of the `MesloLGS NF` variants.
4. **Restart** your terminal to apply the new font.

For full details, see the Powerlevel10k manual:
https://github.com/romkatv/powerlevel10k#manual-font-installation

---

## Installation & Usage

### 1. Clone the repository

Choose a directory for your helper scripts (we recommend `~/.wsl_scripts`):

```bash
git clone https://github.com/pedr0cazz/wsl-scripts.git ~/.wsl_scripts
chmod +x ~/.wsl_scripts/*.sh
```

### 2. Run the main installer

```bash
~/.wsl_scripts/wsl-setup.sh
```

The script will prompt for:

- **State file path** (default: `~/.wsl_setup_state`) â€“ used to resume if interrupted
- **Project root** (default: `~/www`) â€“ where your sites live
- **SSL directory** (default: `~/ssl`) â€“ certificate storage location
- **Scripts repo URL** (default: this GitHub URL)
- **Local clone path** (default: `~/.wsl_scripts`)

Then it will perform all setup steps quietly, displaying a loading bar for each.

### 3. Activate your Zsh helpers

After the installer finishes, either **restart your shell** or run:

```bash
source ~/.zshrc
```

This enables:

- ðŸ›¡ **Automatic SSL Manager Check**: detects new or removed project folders and regenerates certs
- ðŸš€ **Smart Composer Wrapper**: auto-selects the PHP version per project
- ðŸ”‘ **SSH Agent Auto-Start**: ensures your SSH key is loaded

### 4. Manual SSL Management

If you add a new project folder under your `WEB_ROOT`, the SSL manager will run on the next shell launch. To force a regeneration manually:

```bash
~/.wsl_scripts/ssl-manager.sh
```

---

## Installing the Root CA on Windows

To trust `https://*.test` certificates in Windows, import the root CA generated by the script:

1. **Copy the root certificate** into Windows:
   ```bash
   cp "$SSL_DIR/ca/rootCA.pem" /mnt/c/Users/<YourWindowsUser>/Desktop/rootCA.pem
   ```
2. **Install into Windows Trusted Root**:
   - Double-click `rootCA.pem` on your Desktop.
   - Click **Install Certificate** â†’ choose **Local Machine** â†’ **Next**.
   - Select **Place all certificates in the following store** â†’ **Trusted Root Certification Authorities** â†’ **Finish**.
3. **Restart your browser** and visit `https://myapp.test`â€”youâ€™ll now see a valid lock icon.

---

## Usage Notes

- **Project root**: Any folder under your `WEB_ROOT` (default: `~/www`) becomes `folder.test` with HTTPS.
- **Composer**: Automatically uses the PHP version declared in `composer.json`.
- **Nginx**: Vhosts created for each project; PHP-FPM socket auto-detected.
- **MySQL**: Root user secured with an empty password by default (seek to change in production).
- **Redis**: Installed and running out of the box.

---

## Tutorial: Stepâ€‘byâ€‘Step Example

1. **Create a new Laravel project**:
   ```bash
   mkdir -p ~/www/myapp && cd ~/www/myapp
   composer create-project laravel/laravel .
   ```
2. **Open a new terminal** â†’ Zsh detects the new folder â†’ runs the SSL manager â†’ vhost+cert created.
3. **Browse** `https://myapp.test` to see your app securely served.
4. **Run** `composer` commands to automatically select the correct PHP version.
5. **Use** `ssh` without manual agent startup.

---

## Contributing

Pull requests and issues are welcome! To update your clone:

```bash
git -C ~/.wsl_scripts pull
```

---

## License

This project is licensed under the MIT License. See [LICENSE](./LICENSE) for details.
